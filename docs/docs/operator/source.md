# Источники

Страница **«Источники»** предназначена для создания и конфигурации описаний таблиц данных донора, используемых в системе для последующего формирования сегментов. Источник представляет собой логическую обертку над таблицей, содержащей записи (например, контактная информация, медицинские данные и т.п.). Каждый источник определяет перечень доступных атрибутов, их отображаемые названия и типы контролов для выбора в интерфейсе построения сегментов.

## Основные функции

- Создание и редактирование источников
- Назначение читаемого имени источника
- Добавление атрибутов с конфигурацией:
  - Техническое имя поля
  - Отображаемое имя
  - Тип контрола (для UI построителя сегментов)
- Поддержка различных типов контролов:
  - Текстовое поле (`text`)
  - Числовой ввод (`number`)
  - Переключатель (`boolean`)
  - Выпадающий список (`select`, `multiselect`)
  - Дата / интервал дат (`date`, `range`)

## Структура источника

Каждый источник описывается следующими параметрами:

| Поле          | Тип            | Описание                              |
| ------------- | -------------- | ------------------------------------- |
| `id`          | `number`       | Уникальный идентификатор источника    |
| `name`        | `string`       | Отображаемое имя источника            |
| `systemName`  | `string`       | Системное имя источника               |
| `tableName`   | `string`       | Имя таблицы в БД                      |
| `description` | `string?`      | Описание источника                    |
| `createdAt`   | `string?`      | Дата создания                         |
| `updatedAt`   | `string?`      | Дата последнего изменения             |
| `createdById` | `number?`      | ID пользователя, создавшего источник  |
| `updatedById` | `number?`      | ID пользователя, обновившего источник |
| `attributes`  | `IAttribute[]` | Список атрибутов                      |


### Атрибут источника

Каждое поле (атрибут) описывается следующими параметрами:

| Поле            | Тип           | Описание                                                      |
| --------------- | ------------- | ------------------------------------------------------------- |
| `id`            | `number?`     | Уникальный идентификатор атрибута                             |
| `sourceId`      | `number?`     | Внешний ключ на `Source`                                      |
| `isActive`      | `boolean`     | Является ли атрибут активным                                  |
| `name`          | `string?`     | Отображаемое имя атрибута                                     |
| `systemName`    | `string`      | Системное имя поля таблицы                                    |
| `type`          | `DataType`    | Тип данных                                                    |
| `unit`          | `DataUnit`    | Единица использования (например, фильтрация)                  |
| `control`       | `DataControl` | Тип контрола в UI                                             |
| `allowedValues` | `string?`     | Допустимые значения (для `select`-контролов, строка или JSON) |



## Пример конфигурации источника

```json
{
  "id": 1,
  "name": "Доноры",
  "systemName": "donors",
  "tableName": "donors_table",
  "description": "Список доноров",
  "attributes": [
    {
      "isActive": true,
      "name": "Возраст",
      "systemName": "age",
      "type": "INT",
      "unit": "WHERE",
      "control": "INTEGER"
    },
    {
      "isActive": true,
      "name": "Пол",
      "systemName": "gender",
      "type": "TEXT",
      "unit": "WHERE",
      "control": "GENDER",
      "allowedValues": "male,female"
    },
    {
      "isActive": true,
      "name": "Группа крови",
      "systemName": "blood_type",
      "type": "TEXT",
      "unit": "WHERE",
      "control": "STRING_SELECT",
      "allowedValues": "A+,A-,B+,B-,AB+,AB-,O+,O-"
    }
  ]
}
```


## Использование
- Источники определяются ответственные с определенными ролями или разработчиками системы.
- Атрибуты используются в UI-конструкторе сегментов (Query Builder), где по каждому атрибуту можно задать условия фильтрации.
- Поле control определяет тип компонента, который будет использоваться при выборе значений (например, текстовое поле, переключатель, выпадающий список и пр.).